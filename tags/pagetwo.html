<pagetwo class="app-page"> 
    <header class="header-bar">
        <div class="left">
            <button class="btn pull-left icon icon-arrow-back" data-navigation="$previous-page"></button>
            <h1 class="title">Page Two</h1>
        </div>
    </header>

    <div class="content">
        <div class="padded-full">

            <h2>Order</h2>

            <p>1x Pizza: { pizza }</p>

            <button ref="cancel" class="btn negative cancel" data-order="cancel">Cancel</button>
            <button ref="order" class="btn btn-flat primary order" data-order="order">Order</button>
        </div>
         <button ref="tap" class="btn btn-flat primary order" onclick={ ontap }>Tap</button>
         <a href="#" class="btn primary" data-panel-id="myPanelexample">Open Panel</a>
    </div>
 
    <div id="myPanelexample" class="panel-full">
        <header class="header-bar">
            <a class="btn icon icon-close pull-right" href="#" data-panel-close="true"></a>
            <h1 class="title">Panel</h1>
        </header>

        <div class="content">
            <p class="padded-full">The contents of my panel go here.</p>
        </div>
    </div>
    <script>

        var self = this

        this.pizza = ''


        /**
         * On this page, we define the activity events directly on the tag object with "this"
         * [1] On the create callback, we add tap events on buttons. The OnCreate callback is called once.
         * [2] If the user does not tap on buttons, we cancel the page transition. preventClose => true
         * [3] The OnReady callback is called every time the user comes on this page,
         * here we did not implement it.
        */

        var action = null
        this.ontap = function(e) {
          console.log('tap', e)
        }

        var onAction = function(evt) {
            var target = evt.target
            action = 'ok'
            
            console.info(target === self.refs.order, this)
            if(target.getAttribute('data-order') === 'order') {
              phonon.question('Question ?', 'Danger')
              //phonon.alert('Thank you for your order!', 'Dear customer')
            } else {
              phonon.indicator('wait...', true);
              phonon.alert('Your order has been canceled.', 'Dear customer')
            }
        }

        this.on('create', function() {
            this.refs.order.on('tap', onAction)
            this.refs.cancel.on('tap', onAction)
            // document.querySelector('.order').on('tap', onAction)
            // document.querySelector('.cancel').on('tap', onAction)
            console.info(this)
        })

        this.on('close', function(self) {
            if(action !== null) {
                self.close()
            } else {
                phonon.alert('Before leaving this page, you must perform an action.', 'Action required')
            }
        })

        this.on('hidden', function() {
            action = null
        })

        this.on('hashchanged', function(pizza) {
            self.pizza = pizza
            self.update()
        })

    </script>
</pagetwo>
